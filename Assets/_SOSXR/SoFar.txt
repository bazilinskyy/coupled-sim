15-02-2024

Goal for today: go from 'car' as passenger to 'passenger as passenger'. 

I'm encountering two errors, which seem to be able to overcome by updating:
    https://gamedev.stackexchange.com/questions/186134/a-native-collection-has-not-been-disposed-resulting-in-a-memory-leak-enable-fu
    https://issuetracker.unity3d.com/issues/resetting-event-queue-with-pending-events-error-thrown-after-connecting-client-to-server
However I'll wait with updating. Don't know where it's coming from, and there may be something simpler going on. 

Now with this commit there's passengers inside the car who are actually passengers. Their prefab is still a mess. Will clean that up now.

Create passenger with new 'Passenger' layer, which collides with nothing. 
His RB cannot be kinematic, but can do !Gravity.

Glad I didn't update the UnityTransport package. The issues seemed to have gone away once I picked up all the created null-errors.
Null errors dealing with car-lights etc, which are caused because a passenger doesn't really have a personal own spawned car, ergo no lights.
Once I dealt with all those, the connection errors seemed to have gone away. 

Passengers are now happily in the car. I first disabled all car-components 'around them', and then once that was happy, I deleted all that. 
Now they do have an AnimationRig, which needs some placing. 
I added new targets for Head, Hand and Hand. The Head has two constraints: a pos/rot and a lookat. 
I don't think the lookat is needed for what we're after. I left it on there, but set the weight to 0. 
OK the passengers respond fairly well to their rigs. I will now start making sure that the VR portion of this experience works at least somewhat.






---------------------------


08-02-2024

You can either have 1 human passenger, or 2 cars as passenger, inside your manually driven car...

You can have 1 passenger (clone of pedestrian), as a passenger is fine. One manual car and the passenger sync perfect.
However, 2 is too many, then then they don't sync over the network. 

This is also the case if you run with 3 pedestrians. None sync. 

However, if you have three manually driven cars, all is good. They sync perfect.

So I tried making a car as a pedestrian: "Driven_Passenger_Madtest".... and this works!
To make this work, it needs two separate spawn points, so that they're not colliding. 
Needs to have the tag "ManualCar" removed, and in the PlayerAvatar set it as 'Driven_Avatar', 
so that the PlayerSystem can parent it to the 'real' car. 

Conclusion:
There's simply something about the prefab of the pedestrian which is conflicting with it being used as a 2nd passenger.

Next steps: 
Create a prefab (maybe stripped down of the Hatchback car?) for a passenger which works, even when having 2 of them in the same manual car. 



Best, 
Maarten
